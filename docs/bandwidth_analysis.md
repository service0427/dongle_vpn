# 대역폭 분석 및 속도 최적화 가이드

## 🚨 병목현상 분석

### 1. **이더넷 100Mbps 제한**
```
100Mbps = 12.5MB/s 실제 처리량
- TCP 오버헤드 고려: 약 10-11MB/s
- 양방향 통신: 업/다운 각각 10MB/s
```

### 2. **LTE 동글 대역폭**
```
일반 LTE 동글: 10-50Mbps (1.25-6.25MB/s)
5G 동글: 100-500Mbps (12.5-62.5MB/s)

11~20개 동시 사용 시:
- 최소: 11 x 10Mbps = 110Mbps (이미 초과!)
- 평균: 15 x 30Mbps = 450Mbps
- 최대: 20 x 50Mbps = 1000Mbps (1Gbps)
```

## ⚠️ 문제점

**100Mbps 이더넷으로는 11~20개 동글 감당 불가!**

### 실제 병목 시나리오:
```
20개 동글 → 각 5Mbps씩만 할당 가능
실제 LTE 속도(30-50Mbps)의 10-20%만 활용
```

## 💡 해결방안

### 1. **기가비트 이더넷 업그레이드 (권장)**
```bash
# 1Gbps NIC 추가
- USB 3.0 기가비트 어댑터: 3-5만원
- PCIe 기가비트 카드: 2-3만원
```

### 2. **속도별 최적 구성**

#### SOCKS5 프록시 (가장 빠름)
```
장점:
- 오버헤드 최소 (5-10%)
- 암호화 없음 = 속도 최대
- CPU 부하 낮음

단점:
- 보안 약함
- 애플리케이션 지원 필요
```

#### VPN (중간 속도)
```
장점:
- 전체 트래픽 보호
- 애플리케이션 투명성

단점:
- 암호화 오버헤드 (20-30%)
- CPU 부하 높음
- 패킷 크기 증가
```

### 3. **트래픽 관리 전략**

#### A. QoS 설정
```bash
# 동글별 대역폭 제한
tc qdisc add dev enp0s21f0u4 root handle 1: htb default 30
tc class add dev enp0s21f0u4 parent 1: classid 1:1 htb rate 5mbit
tc class add dev enp0s21f0u4 parent 1: classid 1:2 htb rate 5mbit
```

#### B. 로드 밸런싱
```bash
# 여러 이더넷 포트 활용
eno1: 동글 1-5 (100Mbps)
eno2: 동글 6-10 (100Mbps)  
usb_eth1: 동글 11-15 (1Gbps)
usb_eth2: 동글 16-20 (1Gbps)
```

#### C. 동적 할당
```python
# 사용량 기반 동적 라우팅
if dongle_traffic > threshold:
    switch_to_less_loaded_interface()
```

## 📊 실제 성능 비교

| 방식 | 지연시간 | 처리량 | CPU 사용률 | 추천도 |
|------|---------|--------|------------|--------|
| SOCKS5 | 최소 (+0-5ms) | 95-100% | 5-10% | ⭐⭐⭐⭐⭐ |
| HTTP Proxy | 낮음 (+5-10ms) | 90-95% | 10-15% | ⭐⭐⭐⭐ |
| VPN (WireGuard) | 중간 (+10-20ms) | 70-80% | 20-30% | ⭐⭐⭐ |
| VPN (OpenVPN) | 높음 (+20-50ms) | 50-70% | 30-50% | ⭐⭐ |

## 🎯 권장 설정

### 11~20개 동글 운영 시:

1. **네트워크 업그레이드**
   - 기가비트 이더넷 필수
   - USB 3.0 허브 사용
   - 동글당 USB 3.0 포트 할당

2. **프로토콜 선택**
   - 속도 우선: SOCKS5
   - 보안 우선: WireGuard VPN
   - 절충안: SOCKS5 + HTTPS

3. **트래픽 분산**
   ```
   고속 작업 → SOCKS5 (포트 1080-1090)
   일반 작업 → VPN (포트 51820-51830)
   백그라운드 → 직접 연결
   ```

4. **모니터링**
   ```bash
   # 실시간 대역폭 모니터링
   iftop -i eno1
   vnstat -l -i eno1
   ```

## 결론

**현재 100Mbps로는 한계가 명확합니다.**

최적 구성:
1. 기가비트 이더넷 업그레이드
2. SOCKS5 프록시 메인 사용
3. 동글별 5Mbps 제한 설정
4. 로드 밸런싱 구현